{% extends 'ui/base_console.html' %}
{% block title %}Overview Â· Buho{% endblock %}
{% block breadcrumbs %}Overview{% endblock %}
{% block content %}
<form id="overview-filters" class="glass p-4 mb-4 grid md:grid-cols-5 gap-3" hx-get="{% url 'ui:overview_kpis_partial' %}" hx-target="#kpi-zone" hx-trigger="change from:select, keyup delay:500ms from:input">
  <select name="provider" class="bg-slate-900 border border-slate-700 rounded px-2 py-2"><option value="">Provider</option>{% for key,label in providers %}<option value="{{ key }}" {% if filters.provider == key %}selected{% endif %}>{{ label }}</option>{% endfor %}</select>
  <select name="server" class="bg-slate-900 border border-slate-700 rounded px-2 py-2"><option value="">Server</option>{% for server in servers %}<option value="{{ server.id }}" {% if filters.server == server.id|stringformat:'s' %}selected{% endif %}>{{ server.hostname }}</option>{% endfor %}</select>
  <select name="app" class="bg-slate-900 border border-slate-700 rounded px-2 py-2"><option value="">App</option>{% for app in all_apps %}<option value="{{ app.id }}" {% if filters.app == app.id|stringformat:'s' %}selected{% endif %}>{{ app.name }}</option>{% endfor %}</select>
  <select name="time_range" class="bg-slate-900 border border-slate-700 rounded px-2 py-2"><option value="15m" {% if filters.time_range == '15m' %}selected{% endif %}>15m</option><option value="1h" {% if filters.time_range == '1h' %}selected{% endif %}>1h</option><option value="24h" {% if filters.time_range == '24h' %}selected{% endif %}>24h</option><option value="7d" {% if filters.time_range == '7d' %}selected{% endif %}>7d</option></select>
  <div class="htmx-indicator skeleton"></div>
</form>
<div id="kpi-zone">{% include 'ui/partials/overview_kpis.html' %}</div>
<div id="charts-zone" class="mt-4">{% include 'ui/partials/overview_charts.html' %}</div>
<div id="tables-zone" class="mt-4">{% include 'ui/partials/overview_tables.html' %}</div>
<script>
const updateOverviewPanels=()=>{const q=new URLSearchParams(new FormData(document.getElementById('overview-filters'))).toString();htmx.ajax('GET','{% url 'ui:overview_charts_partial' %}?'+q,{target:'#charts-zone'});htmx.ajax('GET','{% url 'ui:overview_tables_partial' %}?'+q,{target:'#tables-zone'});};
document.getElementById('overview-filters').addEventListener('change',updateOverviewPanels);
</script>
{% endblock %}
