{% extends 'ui/base_noc.html' %}
{% block breadcrumbs %}SIEM / Logs{% endblock %}
{% block content %}
<div x-data="{selected:''}" class="grid lg:grid-cols-3 gap-4">
  <div class="lg:col-span-2 glass p-4">
    <h1 class="text-xl mb-3">SIEM Explorer</h1>
    <table class="table-noc"><thead><tr><th>Time</th><th>Level</th><th>Source</th><th>Message</th></tr></thead><tbody>
      {% for log in logs %}<tr @click="selected=`{{ log.message|escapejs }}`"><td>{{ log.ts|date:'Y-m-d H:i:s' }}</td><td><span class="badge-noc {% if log.level == 'ERROR' %}badge-error{% elif log.level == 'WARN' %}badge-warn{% else %}badge-info{% endif %}">{{ log.level }}</span></td><td>{{ log.source }}</td><td>{{ log.message|truncatechars:90 }}</td></tr>{% empty %}<tr><td colspan="4">No telemetry yet â€” Deploy an agent</td></tr>{% endfor %}
    </tbody></table>
  </div>
  <aside class="glass p-4"><h2 class="mb-2">Log detail</h2><p class="text-sm text-slate-300" x-text="selected || 'Select a row to inspect full payload.'"></p><a href="?export=csv" class="btn-noc btn-secondary-noc mt-3 inline-block">Export CSV</a></aside>
</div>
{% endblock %}
