{% extends 'ui/base_noc.html' %}
{% block breadcrumbs %}Agents / Overview{% endblock %}
{% block content %}
<div class="card buho-card mb-3"><div class="card-body"><form class="row g-2"><div class="col-md-3"><select name="provider" class="form-select"><option value="">Provider</option>{% for key,label in providers %}<option value="{{ key }}">{{ label }}</option>{% endfor %}</select></div><div class="col-md-3"><select name="env" class="form-select"><option value="">Env</option>{% for key,label in envs %}<option value="{{ key }}">{{ label }}</option>{% endfor %}</select></div><div class="col-md-4"><input name="q" class="form-control" placeholder="Search"></div><div class="col-md-2"><button class="btn btn-primary w-100">Filter</button></div></form></div></div>
<div class="card buho-card">{% if agents %}<table class="table mb-0" data-datatable="true"><thead><tr><th>Hostname</th><th>Provider</th><th>OS</th><th>Last Seen</th><th>Status</th><th>Version</th><th>Actions</th></tr></thead><tbody>{% for agent in agents %}<tr><td>{{ agent.hostname }}</td><td>{{ agent.get_provider_display }}</td><td>{{ agent.os }}</td><td>{{ agent.last_seen|date:'Y-m-d H:i:s' }}</td><td><span class="badge {% if agent.status == 'ONLINE' %}text-bg-success{% elif agent.status == 'DEGRADED' %}text-bg-warning{% else %}text-bg-danger{% endif %}">{{ agent.status }}</span></td><td>{{ agent.version }}</td><td><a class="btn btn-sm btn-outline-light" href="{% url 'agents:detail' agent.id %}">View</a></td></tr>{% endfor %}</tbody></table>{% else %}<div class="empty-state m-3">Waiting for agent telemetry.</div>{% endif %}</div>
<div class="card buho-card mt-3"><div class="card-body"><h6>Windows Troubleshooting</h6><p class="small text-secondary">View local logs instructions</p><pre>schtasks /Query /TN "BuhoAgent" /V /FO LIST</pre><pre>& "C:\ProgramData\BuhoAgent\venv\Scripts\python.exe" "C:\ProgramData\BuhoAgent\agent.py" --run --config "C:\ProgramData\BuhoAgent\config.json"</pre><pre class="mb-0">Get-Content "C:\ProgramData\BuhoAgent\buho-agent.log" -Tail 200 -Wait</pre></div></div>
{% endblock %}
