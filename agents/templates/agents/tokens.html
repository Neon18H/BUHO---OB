{% extends 'ui/base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3"><h1 class="h3 mb-0">Tokens de enrollment</h1><a href="{% url 'agents:install' %}" class="btn btn-primary">Centro de instalaci√≥n</a></div>
<div class="card table-card">
  <div class="table-responsive sticky-table">
    <table class="table align-middle mb-0">
      <thead><tr><th>Token</th><th>Servidor</th><th>Tags</th><th>Expira</th><th>Estado</th><th></th></tr></thead>
      <tbody>
      {% for token in tokens %}
      <tr>
        <td><code>{{ token.masked_token }}</code></td>
        <td>{{ token.server_name_optional|default:'-' }}</td>
        <td>{% for tag in token.tags_json %}<span class="badge text-bg-light">{{ tag }}</span>{% empty %}-{% endfor %}</td>
        <td>{{ token.expires_at|date:'Y-m-d H:i' }}</td>
        <td>{% if token.is_revoked %}<span class="badge text-bg-danger">Revoked</span>{% elif token.is_used %}<span class="badge text-bg-secondary">Used</span>{% else %}<span class="badge text-bg-success">Available</span>{% endif %}</td>
        <td>{% if not token.is_revoked %}<form method="post" action="{% url 'agents:token_revoke' token.id %}">{% csrf_token %}<button class="btn btn-sm btn-outline-danger">Revocar</button></form>{% endif %}</td>
      </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
