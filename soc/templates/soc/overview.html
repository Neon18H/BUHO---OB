{% extends 'ui/base_console.html' %}
{% block breadcrumbs %}SOC / Overview{% endblock %}
{% block content %}
<div class="row g-3 mb-3">
  <div class="col-md-3"><div class="card buho-card"><div class="card-body"><small class="text-secondary">Eventos 24h</small><div class="kpi-value">{{ events_24h }}</div></div></div></div>
  <div class="col-md-3"><div class="card buho-card"><div class="card-body"><small class="text-secondary">Alerts abiertas</small><div class="kpi-value">{{ alerts_open }}</div></div></div></div>
  <div class="col-md-3"><div class="card buho-card"><div class="card-body"><small class="text-secondary">EPS estimado</small><div class="kpi-value">{{ eps }}</div></div></div></div>
  <div class="col-md-3"><div class="card buho-card"><div class="card-body"><small class="text-secondary">Severidades activas</small><div class="kpi-value">{{ top_severities|length }}</div></div></div></div>
</div>
{% if empty %}
<div class="empty-state"><i class="bi bi-radioactive me-1"></i> Esperando telemetría del agente…</div>
{% else %}
<div class="row g-3"><div class="col-lg-6"><div class="card buho-card p-3"><h6>Severity by hour</h6><canvas id="socSevHour"></canvas></div></div><div class="col-lg-6"><div class="card buho-card p-3"><h6>Top event types</h6><canvas id="socTypes"></canvas></div></div></div>
<div class="card buho-card mt-3"><div class="card-header">Top agents</div><div class="card-body">{% for a in top_agents %}<span class="badge text-bg-dark me-2">{{ a.agent__hostname|default:'Unknown' }}: {{ a.total }}</span>{% endfor %}</div></div>
{% endif %}
{% endblock %}
{% block scripts %}{% if not empty %}<script>
new Chart(document.getElementById('socSevHour'),{type:'bar',data:{labels:{{ sev_labels|safe }},datasets:[{label:'Events',data:{{ sev_values|safe }},backgroundColor:'#3b82f6'}]}});
new Chart(document.getElementById('socTypes'),{type:'doughnut',data:{labels:{{ type_labels|safe }},datasets:[{data:{{ type_values|safe }}}]}});
</script>{% endif %}{% endblock %}
